<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <title>Logbook F√°cil - Voz do Condutor</title>
    </head>
<body>
    <div id="dashboard">
        <h1>üõ†Ô∏è Registo de Manuten√ß√£o</h1>
        <p>KM Atual: <input type="number" id="current_km" value="169000"></p>

        <form id="maintenance_form">
            Descri√ß√£o: <input type="text" id="desc" required>
            KM da Interven√ß√£o: <input type="number" id="m_km" required>
            <button type="submit">Registar</button>
        </form>

        <h2>üö® Alertas</h2>
        <div id="alerts_display"></div>

        <h2>üìù Hist√≥rico</h2>
        <ul id="history_list">
            </ul>
        
        <button id="download_pdf">Descarregar Relat√≥rio PDF</button>
    </div>

    <script>
        const ALERTA_OLEO_KM = 15000;
        let records = JSON.parse(localStorage.getItem('vdc_logbook')) || [];

        function saveRecords() {
            localStorage.setItem('vdc_logbook', JSON.stringify(records));
        }

        function checkAlerts(currentKm) {
            document.getElementById('alerts_display').innerHTML = '';
            
            // 1. Alerta de √ìleo
            const lastOil = records.find(r => r.desc.toLowerCase().includes('√≥leo'));
            if (lastOil) {
                const nextOilKm = lastOil.km + ALERTA_OLEO_KM;
                const kmLeft = nextOilKm - currentKm;
                if (kmLeft < 2000) {
                    document.getElementById('alerts_display').innerHTML += 
                        `<p style="color:red;">Aten√ß√£o: Troca de √ìleo em ${kmLeft} km.</p>`;
                }
            }
        }

        document.getElementById('maintenance_form').addEventListener('submit', function(e) {
            e.preventDefault();
            const desc = document.getElementById('desc').value;
            const km = parseInt(document.getElementById('m_km').value);
            
            records.push({ desc: desc, km: km, date: new Date().toLocaleDateString() });
            saveRecords();
            renderHistory();
            checkAlerts(parseInt(document.getElementById('current_km').value));
            this.reset();
        });

        // (Faltaria a fun√ß√£o renderHistory e a l√≥gica do PDF, que usariam as bibliotecas JS)

        // Inicializar com os dados guardados
        renderHistory();
        checkAlerts(parseInt(document.getElementById('current_km').value));
    </script>
</body>
</html>
