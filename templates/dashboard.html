<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <title>Dashboard - Voz do Condutor</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .alert-box { border: 1px solid #ff9900; padding: 15px; margin-bottom: 20px; background-color: #fff8e1; border-left: 5px solid #ff9900; }
        .urgent { border-color: #d32f2f; background-color: #ffebee; border-left: 5px solid #d32f2f; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        .actions { margin-bottom: 20px; }
        .btn { padding: 10px 20px; text-decoration: none; color: white; border-radius: 5px; cursor: pointer; border: none; }
        .btn-primary { background-color: #007bff; }
        .btn-secondary { background-color: #6c757d; margin-left: 10px; }
        .logo { font-size: 24px; font-weight: bold; color: #007bff; margin-bottom: 20px; }

        /* Estilos de Impress√£o */
        @media print {
            .actions, .logo { display: none; }
            body { margin: 0; padding: 0; }
            table { font-size: 10pt; }
            .alert-box { border: 1px solid black; break-inside: avoid; }
        }
    </style>
</head>
<body>
    <header class="logo">VOZ DO CONDUTOR - Logbook</header>

    <div class="actions">
        <a href="{{ url_for('register_maintenance') }}" class="btn btn-primary">Registar Nova Manuten√ß√£o</a>
        <a href="#" onclick="window.print()" class="btn btn-secondary">Imprimir Hist√≥rico (Simples)</a>
        <a href="{{ url_for('download_report') }}" class="btn btn-secondary">Download Relat√≥rio PDF (c/ Gr√°fico)</a>
    </div>

    <h1>Relat√≥rio do Ve√≠culo ({{ vehicle.license_plate }})</h1>
    <p><strong>KM Atual:</strong> {{ vehicle.current_mileage | format_km }} km</p>
    
    <h2>üö® Alertas Ativos</h2>
    {% if alerts %}
        {% for key, message in alerts.items() %}
            <div class="alert-box {% if 'URGENTE' in message %}urgent{% endif %}">
                <strong>{{ key }}:</strong> {{ message }}
            </div>
        {% endfor %}
    {% else %}
        <p>‚úÖ Sem alertas de manuten√ß√£o pendentes.</p>
    {% endif %}

    <h2>üìù Hist√≥rico de Manuten√ß√£o</h2>
    {% if records %}
        <table>
            <thead>
                <tr>
                    <th>Data</th>
                    <th>KM</th>
                    <th>Descri√ß√£o</th>
                    <th>Custo (‚Ç¨)</th>
                </tr>
            </thead>
            <tbody>
                {% for record in records %}
                <tr>
                    <td>{{ record.date }}</td>
                    <td>{{ record.mileage | format_km }}</td>
                    <td>{{ record.description }}</td>
                    <td>{{ record.cost | format_currency }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>Ainda n√£o existem registos de manuten√ß√£o.</p>
    {% endif %}

</body>
</html>
